extraEnvVars:
  - name: KEYCLOAK_LOG_LEVEL
    value: DEBUG

## @param proxy reverse Proxy mode edge, reencrypt, passthrough or none
## ref: https://www.keycloak.org/server/reverseproxy
##
proxy: edge # passthrough/edge/none/reencrytpt

auth:
  existingSecret: keycloak-auth
  passwordSecretKey: admin-password
  # existingSecret:
  #   name: keycloak-auth
  #   keyMapping:
  #     admin-password: admin-password
  #     management-password: management-password
ingress:
  enabled: true
  # path: / #/*
  ingressClassName: ingress-nginx-admin
  hostname: &hostname keycloak.admin.plato-devncoargo.dev-sbr.com
  extraTls:
  - secretName: keycloak-ca #keycloak-tls-certificate
    hosts:
      - *hostname
  annotations:
    kubernetes.io/tls-acme: "true"
    nginx.ingress.kubernetes.io/enable-access-log: "true"
    nginx.ingress.kubernetes.io/enable-rewrite-log: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "false"
    nginx.org/server-snippets: |
      location /auth {
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-Host $host;
      }
service:
  type: ClusterIP

# https://github.com/adorsys/keycloak-config-cli
# https://github.com/adorsys/keycloak-config-cli/blob/main/docs/FEATURES.md
# https://hub.docker.com/r/adorsys/keycloak-config-cli
keycloakConfigCli:
  enabled: true
  extraEnvVars:
  - name: IMPORT_FILES
    value: /secret/*
  - name: LOGGING_LEVEL_ROOT
    value: debug
  extraVolumeMounts:
  - mountPath: /secret
    name: cfg
    readOnly: true
  extraVolumes:
  - name: cfg
    secret:
      secretName: keycloak-config
  command:
   - sh
   - "-c"
   - |
     /bin/bash <<'EOF'
       echo "done"
     EOF
   #java -jar /opt/bitnami/keycloak-config-cli/keycloak-config-cli-19.0.3.jar --import.files.locations=/secret/config.yaml --keycloak.ssl-verify=false

  # command:
  #   - sh
  #   - "-c"
  #   - |
  #     /bin/bash <<'EOF'
  #       echo "done"
  #     EOF